!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@braid/vue-formulate"),require("@braid/vue-formulate/src/libs/utils.js"),require("imask"),require("@braid/vue-formulate/src/Formulate")):"function"==typeof define&&define.amd?define(["exports","@braid/vue-formulate","@braid/vue-formulate/src/libs/utils.js","imask","@braid/vue-formulate/src/Formulate"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).VueFormulateExtended={},t.VueFormulate,t.utils_js,t.IMask,t.Formulate$1)}(this,(function(t,e,o,n,r){"use strict";function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var a=s(e),i=s(n),u=s(r),c=function(t){return void 0===t&&(t=[]),this.defaultHook=function(t){return t},this.setHooks(t)};c.prototype.parse=function(t){void 0===t&&(t=[]);var e=Array.isArray(t)?t:[];for(var o of e)this.isProperHook(o)&&this.hooks.push(o);return this},c.prototype.addHook=function(t){return this.isProperHook(t)&&this.isNewHook(t)&&this.hooks.push(t),this},c.prototype.setHooks=function(t){return void 0===t&&(t=[]),this.hooks=t.filter(this.isProperHook),this},c.prototype.setDefault=function(t){return this.defaultHook=t,this},c.prototype.isProperHook=function(t){return t&&"object"==typeof t&&"function"==typeof t.handler},c.prototype.isNewHook=function(t){return this.hooks.findIndex((function(e){return e===t}))<0},c.prototype.getHooks=function(){return this.hooks},c.prototype.empty=function(){return 0===this.hooks.length},c.prototype.apply=function(t,e){return this.empty()?this.defaultHook(t,e):this.hooks.reduce((function(t,o){return o.handler(t,e)}),t)},c.prototype.asSingleHook=function(){var t=this;return{handler:function(e,o){return t.apply(e,o)}}};var l={type:Object,default:function(){return{model:[],schema:[],schemaOptions:[],schemaNode:[],schemaComponent:[]}}};var p=a.default.defaults.components.FormulateInput,h=p.props;p.created;var f=p.watch,d=p.computed,m=function(t,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(o[n]=t[n]);return o}(p,["props","created","watch","computed"]);function v(t,e,o,n,r,s,a,i,u,c){"boolean"!=typeof a&&(u=i,i=a,a=!1);var l,p="function"==typeof o?o.options:o;if(t&&t.render&&(p.render=t.render,p.staticRenderFns=t.staticRenderFns,p._compiled=!0,r&&(p.functional=!0)),n&&(p._scopeId=n),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,u(t)),t&&t._registeredComponents&&t._registeredComponents.add(s)},p._ssrRegister=l):e&&(l=a?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,i(t))}),l)if(p.functional){var h=p.render;p.render=function(t,e){return l.call(e),h(t,e)}}else{var f=p.beforeCreate;p.beforeCreate=f?[].concat(f,l):[l]}return o}var y=Object.assign({},m,{props:Object.assign({},h,{modelHook:{type:[Function,Object,Array],default:null},standalone:{type:Boolean,default:function(){return!1}}}),created:function(){this.applyInitialValue(),!this.standalone&&this.formulateRegister&&"function"==typeof this.formulateRegister&&this.formulateRegister(this.nameOrFallback,this),this.applyDefaultValue(),this.disableErrors||"function"!=typeof this.observeErrors||this.observeErrors({callback:this.setErrors,type:"input",field:this.nameOrFallback}),this.updateLocalAttributes(this.$attrs),this.performValidation()},computed:Object.assign({},d,{slotProps:function(){var t=this.$formulate.slotProps.bind(this.$formulate);return{label:t(this.type,"label",this.typeProps),help:t(this.type,"help",this.typeProps),errors:t(this.type,"errors",this.typeProps),repeatable:t(this.type,"repeatable",this.typeProps),addMore:t(this.type,"addMore",this.typeProps),remove:t(this.type,"remove",this.typeProps),component:t(this.type,"component",this.typeProps)}}}),watch:Object.assign({},f,{"context.model":{handler:function(t,e){var o=new c;Array.isArray(this.modelHook)?this.modelHook.map((function(t){return o.addHook(t)})):"function"==typeof this.modelHook?o.addHook({handler:this.modelHook}):o.addHook(this.modelHook),(this.$formulate.options.hooks&&this.$formulate.options.hooks.model?this.$formulate.options.hooks.model:[]).map((function(t){return o.addHook(t)}));var n=t;"box"===this.context.classification&&"string"==typeof t&&0===t.length&&(n=!1),t!==e&&o.hooks.length>0&&(this.context.model=o.apply(n,{oldModel:e,context:this.context}))}}})}),k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:t.context.classes.outer,attrs:{"data-classification":t.classification,"data-has-errors":t.hasErrors,"data-is-showing-errors":t.hasVisibleErrors,"data-has-value":t.hasValue,"data-type":t.type},on:{click:function(e){return t.$emit("outer-click")}}},[o("div",{class:t.context.classes.wrapper,on:{click:function(e){return t.$emit("wrapper-click")}}},["before"===t.context.labelPosition?t._t("label",[t.context.hasLabel?o(t.context.slotComponents.label,t._b({tag:"component",attrs:{context:t.context}},"component",t.context.slotProps.label,!1)):t._e()],null,t.context):t._e(),t._v(" "),"before"===t.context.helpPosition?t._t("help",[t.context.help?o(t.context.slotComponents.help,t._b({tag:"component",attrs:{context:t.context}},"component",t.context.slotProps.help,!1)):t._e()],null,t.context):t._e(),t._v(" "),t._t("element",[o(t.context.component,t._g(t._b({tag:"component",attrs:{context:t.context}},"component",t.context.slotProps.component,!1),t.listeners),[t._t("default",null,null,t.context)],2)],null,t.context),t._v(" "),"after"===t.context.labelPosition?t._t("label",[t.context.hasLabel?o(t.context.slotComponents.label,t._b({tag:"component",attrs:{context:t.context}},"component",t.context.slotProps.label,!1)):t._e()],null,t.context):t._e()],2),t._v(" "),"after"===t.context.helpPosition?t._t("help",[t.context.help?o(t.context.slotComponents.help,t._b({tag:"component",attrs:{context:t.context}},"component",t.context.slotProps.help,!1)):t._e()],null,t.context):t._e(),t._v(" "),t._t("errors",[t.context.disableErrors?t._e():o(t.context.slotComponents.errors,t._b({tag:"component",attrs:{type:"FormulateErrors"===t.context.slotComponents.errors&&"input",context:t.context}},"component",t.context.slotProps.errors,!1))],null,t.context)],2)};k._withStripped=!0;var b=v({render:k,staticRenderFns:[]},void 0,y,void 0,!1,void 0,!1,void 0,void 0,void 0);function x(t,e,o){void 0===o&&(o={});var n=o.hooks,r=o.h,s=o.state;if(t&&"object"==typeof t&&!Array.isArray(t)){var a=t.children;void 0===a&&(a=null);var i=t.component;void 0===i&&(i=b);var u=t.depth;void 0===u&&(u=1);var l=t.modelHook,p=function(t,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(o[n]=t[n]);return o}(t,["children","component","depth","modelHook"]),h=i===b?p.type||"text":"",f=p.name||h||"el",d=p.id||f+"-"+u+"-"+e,m=Array.isArray(a)?a.map((function(t){return Object.assign(t,{depth:u+1})})):a,v=(new c).setHooks(n.model).addHook(l).asSingleHook(),y=Object.assign({name:f,type:h,key:d,depth:u,component:i,definition:{attrs:Object.assign({},p,{modelHook:v})},children:_(m,{hooks:n,h:r,state:s})});return(new c).setHooks(n.schemaNode).setDefault((function(){return y})).apply(y,{state:s})}return null}function _(t,e){void 0===e&&(e={});var o=e.hooks,n=e.h,r=e.state;return Array.isArray(t)?t.map((function(t,e){var s=x(t,e,{hooks:o,h:n,state:r});return(new c).setHooks(o.schemaComponent).setDefault((function(){return n(s.component,s.definition,s.children)})).apply(s)})):t}var g={functional:!1,name:"FormulateSchema",props:{schema:a.default.defaults.components.FormulateForm.props.schema,hooks:l,formClass:{type:String,default:null}},data:function(){return{schemaHooks:null,schemaOptionsHooks:null}},methods:{emit:function(t,e){this.$emit(t,e)}},beforeMount:function(){this.schemaHooks=(new c).setHooks(this.hooks.schema),this.schemaOptionsHooks=(new c).setHooks(this.hooks.schemaOptions).setDefault((function(t){return t}))},render:function(t){return this.schemaHooks.apply(t("div",{class:this.$props.formClass},_(this.schema,this.schemaOptionsHooks.apply({hooks:this.hooks,h:t,state:{}},{emit:this.emit,props:this.$props}))),{emit:this.emit,props:this.$props})}},H={extends:a.default.defaults.components.FormulateForm,components:{FormulateSchema:g},props:{hooks:l,formClass:{type:String,default:null}},computed:{cleanedHooks:function(){var t=this,e=l.default();return Object.keys(e).forEach((function(o){e[o]=(new c).parse(t.hooks[o]).getHooks()})),a.default.merge(this.$formulate.options.hooks||{},e)}},watch:{formulateValue:{handler:function(t){var e=this;this.isVmodeled&&t&&"object"==typeof t&&Array.from(new Set(Object.keys(t).concat(Object.keys(this.proxy)))).forEach((function(n){o.equals(t[n],e.proxy[n])||(e.setFieldValue(n,t[n]),e.registry.has(n)&&!o.equals(t[n],e.registry.get(n).proxy)&&(e.registry.get(n).context.model=t[n]))}))},deep:!0}}},F=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("form",{class:t.classes,on:{submit:function(e){return e.preventDefault(),t.formSubmitted(e)}}},[t.schema?o("FormulateSchema",{attrs:{schema:t.schema,hooks:t.cleanedHooks,formClass:t.formClass},on:{events:function(e){return t.$emit("events",e)}}}):t._e(),t._v(" "),t.hasFormErrorObservers?t._e():o("FormulateErrors",{attrs:{context:t.formContext}}),t._v(" "),t._t("default")],2)};F._withStripped=!0;var O=v({render:F,staticRenderFns:[]},void 0,H,void 0,!1,void 0,!1,void 0,void 0,void 0),P=function(){this.store=new Map};P.prototype.on=function(t,e){var o=this.store.get(t);o&&o.push(e)||this.store.set(t,[e])},P.prototype.off=function(t,e){var o=this.store.get(t),n=o.indexOf(e);o&&n>-1&&o.splice(n,1)},P.prototype.emit=function(t,e){this.store.get(t).slice().map((function(t){return t(e)}))};var j={hooks:{schemaOptions:[{handler:function(t,e){void 0===e&&(e={});var o=e.emit;return t.state=t.state||{},t.state.eventBus=new P,t.state.eventBus.on("events",(function(t){return o("events",t)})),t}}],schemaNode:[{handler:function(t,e){void 0===e&&(e={});var o=e.state,n=t.definition.attrs,r=n.events;void 0===r&&(r=[]);var s=n.on;void 0===s&&(s={});var a=function(t,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(o[n]=t[n]);return o}(n,["events","on"]);return t.definition.attrs=a,t.definition.on=Object.assign({},s,r.reduce((function(e,n){return e[n]=function(e){s[n]&&s[n](e),o.eventBus.emit("events",{eventName:n,name:t.name,type:t.type,key:t.key,payload:e})},e}),{})),t}}]}},w={hooks:{model:[{handler:function(t,e){var o=e.context,n="vfe-mask"in o.attributes||"vfeMask"in o.attributes;if("text"===o.classification&&n){var r=o.attributes["vfe-mask"]||o.attributes.vfeMask,s="object"==typeof r&&r.mask?r:{mask:r};return i.default.createMask(s).resolve(t)}return t}}]}},$={hooks:{model:[{handler:function(t,e){var o=e.context,n="string"==typeof o.attributes.vfeNumber||o.attributes.vfeNumber||"string"==typeof o.attributes["vfe-number"]||o.attributes["vfe-number"];return"number"===o.type&&"string"==typeof t&&n?+t:t}}]}},C={FormulateForm:O,FormulateSchema:g,FormulateInput:b},E={formEvents:j,enforceNumber:$,textMask:w};t.components=C,t.default=function(t){void 0===t&&(t={});var e=u.default.merge({features:{formEvents:!0,textMask:!1,enforceNumber:!1},override:{FormulateForm:!0,FormulateInput:!0,FormulateSchema:!0}},t);return function(t){e.override.FormulateForm&&t.extend({components:{FormulateForm:O}}),e.override.FormulateInput&&t.extend({components:{FormulateInput:b}}),e.override.FormulateSchema&&t.extend({components:{FormulateSchema:g}}),e.features.formEvents&&t.extend(j),e.features.textMask&&t.extend(w),e.features.enforceNumber&&t.extend($)}},t.features=E,Object.defineProperty(t,"__esModule",{value:!0})}));
